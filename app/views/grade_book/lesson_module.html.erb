<div class="col-xl-12 col-md-12 col-sm-12 col-xs-12 home-page-card-opacity">
  <div class="jumbotron">
    <div class="col-xl-12 col-md-12 col-xs-12">
      <div>
        <h1>Module View</h1>
        <% attempts = @lesson_module.attempts %>
        <% questions_length = @lesson_module.questions.length %>
        <table class="table table-bordered">
          <thead>
          <tr>
            <th>Student Name</th>
            <!-- TODO: This needs to be on a different page or passed in a specific lesson moduel-->
            <% @lesson_module.questions.each do |question| %>
                <th colspan="11"><%= question.question_string %></th>
            <% end %>
          </tr>

          <tr>
            <th></th>
            <% (0...questions_length).each do %>
                <% (0...attempts).each do | index| %>
                    <th colspan="3">Answer <%= index + 1 %></th>
                <% end %>
                <th colspan="2">Total Grade</th>
            <% end %>
          </tr>
          <tr>
            <th></th>
            <% (0...questions_length).each do %>
                <% (0...attempts).each do %>
                    <th colspan="1">Choice</th>
                    <th colspan="1">Correct</th>
                    <th colspan="1">Time</th>
                <% end %>
                <th>Grade</th>
                <th>Time</th>
            <% end %>
          </tr>
          </thead>

          <tbody>
          <% users = User.with_role(:student, @course) %>
          <% questions = @lesson_module.questions %>
          <% users.each do |user| %>
              <td><%= user.name %></td>
              <% questions.each do |question| %>
                  <% answers = Gradebook.lesson_model_grade(user,question)%>
                  <% correct = false %>
                  <% total_time = 0 %>
                  <% answers.each do |answer| %>
                      <!-- TODO: Does he want to see their choice? -->
                      <td>A</td>
                      <td><%= answer.correct %></td>
                      <td><%= answer.time_to_complete %></td>
                      <% correct = answer.correct unless correct  %>
                      <% total_time += answer.time_to_complete %>
                  <% end %>
                  <% (answers.length...attempts).each do %>
                      <td></td>
                      <td></td>
                      <td></td>
                  <% end %>
                  <td><%= correct ? '100%' : '0%' %></td>
                  <td><%= total_time %> sec</td>
              <% end %>
              </tr>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
</div>